"use strict";exports.id=391,exports.ids=[391],exports.modules={8391:(a,b,c)=>{var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ab,ac,ad,ae,af,ag,ah,ai,aj,ak,al;let am,an,ao;function ap(a,b,c,d,e){if("m"===d)throw TypeError("Private method is not writable");if("a"===d&&!e)throw TypeError("Private accessor was defined without a setter");if("function"==typeof b?a!==b||!e:!b.has(a))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===d?e.call(a,c):e?e.value=c:b.set(a,c),c}function aq(a,b,c,d){if("a"===c&&!d)throw TypeError("Private accessor was defined without a getter");if("function"==typeof b?a!==b||!d:!b.has(a))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===c?d:"a"===c?d.call(a):d?d.value:b.get(a)}c.d(b,{Ay:()=>bZ});let ar=function(){let{crypto:a}=globalThis;if(a?.randomUUID)return ar=a.randomUUID.bind(a),a.randomUUID();let b=new Uint8Array(1),c=a?()=>a.getRandomValues(b)[0]:()=>255*Math.random()&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,a=>(a^c()&15>>a/4).toString(16))};function as(a){return"object"==typeof a&&null!==a&&("name"in a&&"AbortError"===a.name||"message"in a&&String(a.message).includes("FetchRequestCanceledException"))}let at=a=>{if(a instanceof Error)return a;if("object"==typeof a&&null!==a){try{if("[object Error]"===Object.prototype.toString.call(a)){let b=Error(a.message,a.cause?{cause:a.cause}:{});return a.stack&&(b.stack=a.stack),a.cause&&!b.cause&&(b.cause=a.cause),a.name&&(b.name=a.name),b}}catch{}try{return Error(JSON.stringify(a))}catch{}}return Error(a)};class au extends Error{}class av extends au{constructor(a,b,c,d){super(`${av.makeMessage(a,b,c)}`),this.status=a,this.headers=d,this.requestID=d?.get("request-id"),this.error=b}static makeMessage(a,b,c){let d=b?.message?"string"==typeof b.message?b.message:JSON.stringify(b.message):b?JSON.stringify(b):c;return a&&d?`${a} ${d}`:a?`${a} status code (no body)`:d||"(no status code or body)"}static generate(a,b,c,d){return a&&d?400===a?new az(a,b,c,d):401===a?new aA(a,b,c,d):403===a?new aB(a,b,c,d):404===a?new aC(a,b,c,d):409===a?new aD(a,b,c,d):422===a?new aE(a,b,c,d):429===a?new aF(a,b,c,d):a>=500?new aG(a,b,c,d):new av(a,b,c,d):new ax({message:c,cause:at(b)})}}class aw extends av{constructor({message:a}={}){super(void 0,void 0,a||"Request was aborted.",void 0)}}class ax extends av{constructor({message:a,cause:b}){super(void 0,void 0,a||"Connection error.",void 0),b&&(this.cause=b)}}class ay extends ax{constructor({message:a}={}){super({message:a??"Request timed out."})}}class az extends av{}class aA extends av{}class aB extends av{}class aC extends av{}class aD extends av{}class aE extends av{}class aF extends av{}class aG extends av{}let aH=/^[a-z][a-z0-9+.-]*:/i,aI=a=>(aI=Array.isArray)(a),aJ=aI;function aK(a){return"object"!=typeof a?{}:a??{}}let aL=a=>{try{return JSON.parse(a)}catch(a){return}},aM="0.68.0",aN=a=>"x32"===a?"x32":"x86_64"===a||"x64"===a?"x64":"arm"===a?"arm":"aarch64"===a||"arm64"===a?"arm64":a?`other:${a}`:"unknown",aO=a=>(a=a.toLowerCase()).includes("ios")?"iOS":"android"===a?"Android":"darwin"===a?"MacOS":"win32"===a?"Windows":"freebsd"===a?"FreeBSD":"openbsd"===a?"OpenBSD":"linux"===a?"Linux":a?`Other:${a}`:"Unknown";function aP(...a){let b=globalThis.ReadableStream;if(void 0===b)throw Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new b(...a)}function aQ(a){let b=Symbol.asyncIterator in a?a[Symbol.asyncIterator]():a[Symbol.iterator]();return aP({start(){},async pull(a){let{done:c,value:d}=await b.next();c?a.close():a.enqueue(d)},async cancel(){await b.return?.()}})}function aR(a){if(a[Symbol.asyncIterator])return a;let b=a.getReader();return{async next(){try{let a=await b.read();return a?.done&&b.releaseLock(),a}catch(a){throw b.releaseLock(),a}},async return(){let a=b.cancel();return b.releaseLock(),await a,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}async function aS(a){if(null===a||"object"!=typeof a)return;if(a[Symbol.asyncIterator])return void await a[Symbol.asyncIterator]().return?.();let b=a.getReader(),c=b.cancel();b.releaseLock(),await c}let aT=({headers:a,body:b})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(b)});function aU(a){let b;return(an??(an=(b=new globalThis.TextEncoder).encode.bind(b)))(a)}function aV(a){let b;return(ao??(ao=(b=new globalThis.TextDecoder).decode.bind(b)))(a)}class aW{constructor(){d.set(this,void 0),e.set(this,void 0),ap(this,d,new Uint8Array,"f"),ap(this,e,null,"f")}decode(a){let b;if(null==a)return[];let c=a instanceof ArrayBuffer?new Uint8Array(a):"string"==typeof a?aU(a):a;ap(this,d,function(a){let b=0;for(let c of a)b+=c.length;let c=new Uint8Array(b),d=0;for(let b of a)c.set(b,d),d+=b.length;return c}([aq(this,d,"f"),c]),"f");let f=[];for(;null!=(b=function(a,b){for(let c=b??0;c<a.length;c++){if(10===a[c])return{preceding:c,index:c+1,carriage:!1};if(13===a[c])return{preceding:c,index:c+1,carriage:!0}}return null}(aq(this,d,"f"),aq(this,e,"f")));){if(b.carriage&&null==aq(this,e,"f")){ap(this,e,b.index,"f");continue}if(null!=aq(this,e,"f")&&(b.index!==aq(this,e,"f")+1||b.carriage)){f.push(aV(aq(this,d,"f").subarray(0,aq(this,e,"f")-1))),ap(this,d,aq(this,d,"f").subarray(aq(this,e,"f")),"f"),ap(this,e,null,"f");continue}let a=null!==aq(this,e,"f")?b.preceding-1:b.preceding,c=aV(aq(this,d,"f").subarray(0,a));f.push(c),ap(this,d,aq(this,d,"f").subarray(b.index),"f"),ap(this,e,null,"f")}return f}flush(){return aq(this,d,"f").length?this.decode("\n"):[]}}d=new WeakMap,e=new WeakMap,aW.NEWLINE_CHARS=new Set(["\n","\r"]),aW.NEWLINE_REGEXP=/\r\n|[\n\r]/g;let aX={off:0,error:200,warn:300,info:400,debug:500},aY=(a,b,c)=>{if(a){if(Object.prototype.hasOwnProperty.call(aX,a))return a;a1(c).warn(`${b} was set to ${JSON.stringify(a)}, expected one of ${JSON.stringify(Object.keys(aX))}`)}};function aZ(){}function a$(a,b,c){return!b||aX[a]>aX[c]?aZ:b[a].bind(b)}let a_={error:aZ,warn:aZ,info:aZ,debug:aZ},a0=new WeakMap;function a1(a){let b=a.logger,c=a.logLevel??"off";if(!b)return a_;let d=a0.get(b);if(d&&d[0]===c)return d[1];let e={error:a$("error",b,c),warn:a$("warn",b,c),info:a$("info",b,c),debug:a$("debug",b,c)};return a0.set(b,[c,e]),e}let a2=a=>(a.options&&(a.options={...a.options},delete a.options.headers),a.headers&&(a.headers=Object.fromEntries((a.headers instanceof Headers?[...a.headers]:Object.entries(a.headers)).map(([a,b])=>[a,"x-api-key"===a.toLowerCase()||"authorization"===a.toLowerCase()||"cookie"===a.toLowerCase()||"set-cookie"===a.toLowerCase()?"***":b]))),"retryOfRequestLogID"in a&&(a.retryOfRequestLogID&&(a.retryOf=a.retryOfRequestLogID),delete a.retryOfRequestLogID),a);class a3{constructor(a,b,c){this.iterator=a,f.set(this,void 0),this.controller=b,ap(this,f,c,"f")}static fromSSEResponse(a,b,c){let d=!1,e=c?a1(c):console;async function*f(){if(d)throw new au("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");d=!0;let c=!1;try{for await(let c of a4(a,b)){if("completion"===c.event)try{yield JSON.parse(c.data)}catch(a){throw e.error("Could not parse message into JSON:",c.data),e.error("From chunk:",c.raw),a}if("message_start"===c.event||"message_delta"===c.event||"message_stop"===c.event||"content_block_start"===c.event||"content_block_delta"===c.event||"content_block_stop"===c.event)try{yield JSON.parse(c.data)}catch(a){throw e.error("Could not parse message into JSON:",c.data),e.error("From chunk:",c.raw),a}if("ping"!==c.event&&"error"===c.event)throw new av(void 0,aL(c.data)??c.data,void 0,a.headers)}c=!0}catch(a){if(as(a))return;throw a}finally{c||b.abort()}}return new a3(f,b,c)}static fromReadableStream(a,b,c){let d=!1;async function*e(){let b=new aW;for await(let c of aR(a))for(let a of b.decode(c))yield a;for(let a of b.flush())yield a}return new a3(async function*(){if(d)throw new au("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");d=!0;let a=!1;try{for await(let b of e())!a&&b&&(yield JSON.parse(b));a=!0}catch(a){if(as(a))return;throw a}finally{a||b.abort()}},b,c)}[(f=new WeakMap,Symbol.asyncIterator)](){return this.iterator()}tee(){let a=[],b=[],c=this.iterator(),d=d=>({next:()=>{if(0===d.length){let d=c.next();a.push(d),b.push(d)}return d.shift()}});return[new a3(()=>d(a),this.controller,aq(this,f,"f")),new a3(()=>d(b),this.controller,aq(this,f,"f"))]}toReadableStream(){let a,b=this;return aP({async start(){a=b[Symbol.asyncIterator]()},async pull(b){try{let{value:c,done:d}=await a.next();if(d)return b.close();let e=aU(JSON.stringify(c)+"\n");b.enqueue(e)}catch(a){b.error(a)}},async cancel(){await a.return?.()}})}}async function*a4(a,b){if(!a.body){if(b.abort(),void 0!==globalThis.navigator&&"ReactNative"===globalThis.navigator.product)throw new au("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api");throw new au("Attempted to iterate over a response with no body")}let c=new a6,d=new aW;for await(let b of a5(aR(a.body)))for(let a of d.decode(b)){let b=c.decode(a);b&&(yield b)}for(let a of d.flush()){let b=c.decode(a);b&&(yield b)}}async function*a5(a){let b=new Uint8Array;for await(let c of a){let a;if(null==c)continue;let d=c instanceof ArrayBuffer?new Uint8Array(c):"string"==typeof c?aU(c):c,e=new Uint8Array(b.length+d.length);for(e.set(b),e.set(d,b.length),b=e;-1!==(a=function(a){for(let b=0;b<a.length-1;b++){if(10===a[b]&&10===a[b+1]||13===a[b]&&13===a[b+1])return b+2;if(13===a[b]&&10===a[b+1]&&b+3<a.length&&13===a[b+2]&&10===a[b+3])return b+4}return -1}(b));)yield b.slice(0,a),b=b.slice(a)}b.length>0&&(yield b)}class a6{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(a){if(a.endsWith("\r")&&(a=a.substring(0,a.length-1)),!a){if(!this.event&&!this.data.length)return null;let a={event:this.event,data:this.data.join("\n"),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],a}if(this.chunks.push(a),a.startsWith(":"))return null;let[b,c,d]=function(a,b){let c=a.indexOf(":");return -1!==c?[a.substring(0,c),b,a.substring(c+b.length)]:[a,"",""]}(a,":");return d.startsWith(" ")&&(d=d.substring(1)),"event"===b?this.event=d:"data"===b&&this.data.push(d),null}}async function a7(a,b){let{response:c,requestLogID:d,retryOfRequestLogID:e,startTime:f}=b,g=await (async()=>{if(b.options.stream)return(a1(a).debug("response",c.status,c.url,c.headers,c.body),b.options.__streamClass)?b.options.__streamClass.fromSSEResponse(c,b.controller):a3.fromSSEResponse(c,b.controller);if(204===c.status)return null;if(b.options.__binaryResponse)return c;let d=c.headers.get("content-type"),e=d?.split(";")[0]?.trim();return e?.includes("application/json")||e?.endsWith("+json")?a8(await c.json(),c):await c.text()})();return a1(a).debug(`[${d}] response parsed`,a2({retryOfRequestLogID:e,url:c.url,status:c.status,body:g,durationMs:Date.now()-f})),g}function a8(a,b){return!a||"object"!=typeof a||Array.isArray(a)?a:Object.defineProperty(a,"_request_id",{value:b.headers.get("request-id"),enumerable:!1})}class a9 extends Promise{constructor(a,b,c=a7){super(a=>{a(null)}),this.responsePromise=b,this.parseResponse=c,g.set(this,void 0),ap(this,g,a,"f")}_thenUnwrap(a){return new a9(aq(this,g,"f"),this.responsePromise,async(b,c)=>a8(a(await this.parseResponse(b,c),c),c.response))}asResponse(){return this.responsePromise.then(a=>a.response)}async withResponse(){let[a,b]=await Promise.all([this.parse(),this.asResponse()]);return{data:a,response:b,request_id:b.headers.get("request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(a=>this.parseResponse(aq(this,g,"f"),a))),this.parsedPromise}then(a,b){return this.parse().then(a,b)}catch(a){return this.parse().catch(a)}finally(a){return this.parse().finally(a)}}g=new WeakMap;class ba{constructor(a,b,c,d){h.set(this,void 0),ap(this,h,a,"f"),this.options=d,this.response=b,this.body=c}hasNextPage(){return!!this.getPaginatedItems().length&&null!=this.nextPageRequestOptions()}async getNextPage(){let a=this.nextPageRequestOptions();if(!a)throw new au("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");return await aq(this,h,"f").requestAPIList(this.constructor,a)}async *iterPages(){let a=this;for(yield a;a.hasNextPage();)a=await a.getNextPage(),yield a}async *[(h=new WeakMap,Symbol.asyncIterator)](){for await(let a of this.iterPages())for(let b of a.getPaginatedItems())yield b}}class bb extends a9{constructor(a,b,c){super(a,b,async(a,b)=>new c(a,b.response,await a7(a,b),b.options))}async *[Symbol.asyncIterator](){for await(let a of(await this))yield a}}class bc extends ba{constructor(a,b,c,d){super(a,b,c,d),this.data=c.data||[],this.has_more=c.has_more||!1,this.first_id=c.first_id||null,this.last_id=c.last_id||null}getPaginatedItems(){return this.data??[]}hasNextPage(){return!1!==this.has_more&&super.hasNextPage()}nextPageRequestOptions(){if(this.options.query?.before_id){let a=this.first_id;return a?{...this.options,query:{...aK(this.options.query),before_id:a}}:null}let a=this.last_id;return a?{...this.options,query:{...aK(this.options.query),after_id:a}}:null}}class bd extends ba{constructor(a,b,c,d){super(a,b,c,d),this.data=c.data||[],this.has_more=c.has_more||!1,this.next_page=c.next_page||null}getPaginatedItems(){return this.data??[]}hasNextPage(){return!1!==this.has_more&&super.hasNextPage()}nextPageRequestOptions(){let a=this.next_page;return a?{...this.options,query:{...aK(this.options.query),page:a}}:null}}let be=()=>{if("undefined"==typeof File){let{process:a}=globalThis;throw Error("`File` is not defined as a global, which is required for file uploads."+("string"==typeof a?.versions?.node&&20>parseInt(a.versions.node.split("."))?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function bf(a,b,c){return be(),new File(a,b??"unknown_file",c)}function bg(a){return("object"==typeof a&&null!==a&&("name"in a&&a.name&&String(a.name)||"url"in a&&a.url&&String(a.url)||"filename"in a&&a.filename&&String(a.filename)||"path"in a&&a.path&&String(a.path))||"").split(/[\\/]/).pop()||void 0}let bh=a=>null!=a&&"object"==typeof a&&"function"==typeof a[Symbol.asyncIterator],bi=async(a,b)=>({...a,body:await bk(a.body,b)}),bj=new WeakMap,bk=async(a,b)=>{if(!await function(a){let b="function"==typeof a?a:a.fetch,c=bj.get(b);if(c)return c;let d=(async()=>{try{let a="Response"in b?b.Response:(await b("data:,")).constructor,c=new FormData;if(c.toString()===await new a(c).text())return!1;return!0}catch{return!0}})();return bj.set(b,d),d}(b))throw TypeError("The provided fetch function does not support file uploads with the current global FormData class.");let c=new FormData;return await Promise.all(Object.entries(a||{}).map(([a,b])=>bn(c,a,b))),c},bl=a=>a instanceof Blob&&"name"in a,bm=a=>{if((a=>"object"==typeof a&&null!==a&&(a instanceof Response||bh(a)||bl(a)))(a))return!0;if(Array.isArray(a))return a.some(bm);if(a&&"object"==typeof a){for(let b in a)if(bm(a[b]))return!0}return!1},bn=async(a,b,c)=>{if(void 0!==c){if(null==c)throw TypeError(`Received null for "${b}"; to pass null in FormData, you must use the string 'null'`);if("string"==typeof c||"number"==typeof c||"boolean"==typeof c)a.append(b,String(c));else if(c instanceof Response){let d={},e=c.headers.get("Content-Type");e&&(d={type:e}),a.append(b,bf([await c.blob()],bg(c),d))}else if(bh(c))a.append(b,bf([await new Response(aQ(c)).blob()],bg(c)));else if(bl(c))a.append(b,bf([c],bg(c),{type:c.type}));else if(Array.isArray(c))await Promise.all(c.map(c=>bn(a,b+"[]",c)));else if("object"==typeof c)await Promise.all(Object.entries(c).map(([c,d])=>bn(a,`${b}[${c}]`,d)));else throw TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${c} instead`)}},bo=a=>null!=a&&"object"==typeof a&&"number"==typeof a.size&&"string"==typeof a.type&&"function"==typeof a.text&&"function"==typeof a.slice&&"function"==typeof a.arrayBuffer;async function bp(a,b,c){let d,e;if(be(),a=await a,b||(b=bg(a)),null!=(d=a)&&"object"==typeof d&&"string"==typeof d.name&&"number"==typeof d.lastModified&&bo(d))return a instanceof File&&null==b&&null==c?a:bf([await a.arrayBuffer()],b??a.name,{type:a.type,lastModified:a.lastModified,...c});if(null!=(e=a)&&"object"==typeof e&&"string"==typeof e.url&&"function"==typeof e.blob){let d=await a.blob();return b||(b=new URL(a.url).pathname.split(/[\\/]/).pop()),bf(await bq(d),b,c)}let f=await bq(a);if(!c?.type){let a=f.find(a=>"object"==typeof a&&"type"in a&&a.type);"string"==typeof a&&(c={...c,type:a})}return bf(f,b,c)}async function bq(a){let b=[];if("string"==typeof a||ArrayBuffer.isView(a)||a instanceof ArrayBuffer)b.push(a);else if(bo(a))b.push(a instanceof Blob?a:await a.arrayBuffer());else if(bh(a))for await(let c of a)b.push(...await bq(c));else{let b=a?.constructor?.name;throw Error(`Unexpected data type: ${typeof a}${b?`; constructor: ${b}`:""}${function(a){if("object"!=typeof a||null===a)return"";let b=Object.getOwnPropertyNames(a);return`; props: [${b.map(a=>`"${a}"`).join(", ")}]`}(a)}`)}return b}class br{constructor(a){this._client=a}}let bs=Symbol.for("brand.privateNullableHeaders"),bt=a=>{let b=new Headers,c=new Set;for(let d of a){let a=new Set;for(let[e,f]of function*(a){let b;if(!a)return;if(bs in a){let{values:b,nulls:c}=a;for(let a of(yield*b.entries(),c))yield[a,null];return}let c=!1;for(let d of(a instanceof Headers?b=a.entries():aJ(a)?b=a:(c=!0,b=Object.entries(a??{})),b)){let a=d[0];if("string"!=typeof a)throw TypeError("expected header name to be a string");let b=aJ(d[1])?d[1]:[d[1]],e=!1;for(let d of b)void 0!==d&&(c&&!e&&(e=!0,yield[a,null]),yield[a,d])}}(d)){let d=e.toLowerCase();a.has(d)||(b.delete(e),a.add(d)),null===f?(b.delete(e),c.add(d)):(b.append(e,f),c.delete(d))}}return{[bs]:!0,values:b,nulls:c}};function bu(a){return a.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}let bv=Object.freeze(Object.create(null)),bw=((a=bu)=>function(b,...c){let d;if(1===b.length)return b[0];let e=!1,f=[],g=b.reduce((b,d,g)=>{/[?#]/.test(d)&&(e=!0);let h=c[g],i=(e?encodeURIComponent:a)(""+h);return g!==c.length&&(null==h||"object"==typeof h&&h.toString===Object.getPrototypeOf(Object.getPrototypeOf(h.hasOwnProperty??bv)??bv)?.toString)&&(i=h+"",f.push({start:b.length+d.length,length:i.length,error:`Value of type ${Object.prototype.toString.call(h).slice(8,-1)} is not a valid path parameter`})),b+d+(g===c.length?"":i)},""),h=g.split(/[?#]/,1)[0],i=/(?<=^|\/)(?:\.|%2e){1,2}(?=\/|$)/gi;for(;null!==(d=i.exec(h));)f.push({start:d.index,length:d[0].length,error:`Value "${d[0]}" can't be safely passed as a path parameter`});if(f.sort((a,b)=>a.start-b.start),f.length>0){let a=0,b=f.reduce((b,c)=>{let d=" ".repeat(c.start-a),e="^".repeat(c.length);return a=c.start+c.length,b+d+e},"");throw new au(`Path parameters result in path with invalid segments:
${f.map(a=>a.error).join("\n")}
${g}
${b}`)}return g})(bu);class bx extends br{list(a={},b){let{betas:c,...d}=a??{};return this._client.getAPIList("/v1/files",bc,{query:d,...b,headers:bt([{"anthropic-beta":[...c??[],"files-api-2025-04-14"].toString()},b?.headers])})}delete(a,b={},c){let{betas:d}=b??{};return this._client.delete(bw`/v1/files/${a}`,{...c,headers:bt([{"anthropic-beta":[...d??[],"files-api-2025-04-14"].toString()},c?.headers])})}download(a,b={},c){let{betas:d}=b??{};return this._client.get(bw`/v1/files/${a}/content`,{...c,headers:bt([{"anthropic-beta":[...d??[],"files-api-2025-04-14"].toString(),Accept:"application/binary"},c?.headers]),__binaryResponse:!0})}retrieveMetadata(a,b={},c){let{betas:d}=b??{};return this._client.get(bw`/v1/files/${a}`,{...c,headers:bt([{"anthropic-beta":[...d??[],"files-api-2025-04-14"].toString()},c?.headers])})}upload(a,b){let{betas:c,...d}=a;return this._client.post("/v1/files",bi({body:d,...b,headers:bt([{"anthropic-beta":[...c??[],"files-api-2025-04-14"].toString()},b?.headers])},this._client))}}class by extends br{retrieve(a,b={},c){let{betas:d}=b??{};return this._client.get(bw`/v1/models/${a}?beta=true`,{...c,headers:bt([{...d?.toString()!=null?{"anthropic-beta":d?.toString()}:void 0},c?.headers])})}list(a={},b){let{betas:c,...d}=a??{};return this._client.getAPIList("/v1/models?beta=true",bc,{query:d,...b,headers:bt([{...c?.toString()!=null?{"anthropic-beta":c?.toString()}:void 0},b?.headers])})}}class bz{constructor(a,b){this.iterator=a,this.controller=b}async *decoder(){let a=new aW;for await(let b of this.iterator)for(let c of a.decode(b))yield JSON.parse(c);for(let b of a.flush())yield JSON.parse(b)}[Symbol.asyncIterator](){return this.decoder()}static fromResponse(a,b){if(!a.body){if(b.abort(),void 0!==globalThis.navigator&&"ReactNative"===globalThis.navigator.product)throw new au("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api");throw new au("Attempted to iterate over a response with no body")}return new bz(aR(a.body),b)}}class bA extends br{create(a,b){let{betas:c,...d}=a;return this._client.post("/v1/messages/batches?beta=true",{body:d,...b,headers:bt([{"anthropic-beta":[...c??[],"message-batches-2024-09-24"].toString()},b?.headers])})}retrieve(a,b={},c){let{betas:d}=b??{};return this._client.get(bw`/v1/messages/batches/${a}?beta=true`,{...c,headers:bt([{"anthropic-beta":[...d??[],"message-batches-2024-09-24"].toString()},c?.headers])})}list(a={},b){let{betas:c,...d}=a??{};return this._client.getAPIList("/v1/messages/batches?beta=true",bc,{query:d,...b,headers:bt([{"anthropic-beta":[...c??[],"message-batches-2024-09-24"].toString()},b?.headers])})}delete(a,b={},c){let{betas:d}=b??{};return this._client.delete(bw`/v1/messages/batches/${a}?beta=true`,{...c,headers:bt([{"anthropic-beta":[...d??[],"message-batches-2024-09-24"].toString()},c?.headers])})}cancel(a,b={},c){let{betas:d}=b??{};return this._client.post(bw`/v1/messages/batches/${a}/cancel?beta=true`,{...c,headers:bt([{"anthropic-beta":[...d??[],"message-batches-2024-09-24"].toString()},c?.headers])})}async results(a,b={},c){let d=await this.retrieve(a);if(!d.results_url)throw new au(`No batch \`results_url\`; Has it finished processing? ${d.processing_status} - ${d.id}`);let{betas:e}=b??{};return this._client.get(d.results_url,{...c,headers:bt([{"anthropic-beta":[...e??[],"message-batches-2024-09-24"].toString(),Accept:"application/binary"},c?.headers]),stream:!0,__binaryResponse:!0})._thenUnwrap((a,b)=>bz.fromResponse(b.response,b.controller))}}let bB=a=>{if(0===a.length)return a;let b=a[a.length-1];switch(b.type){case"separator":return bB(a=a.slice(0,a.length-1));case"number":let c=b.value[b.value.length-1];if("."===c||"-"===c)return bB(a=a.slice(0,a.length-1));case"string":let d=a[a.length-2];if(d?.type==="delimiter"||d?.type==="brace"&&"{"===d.value)return bB(a=a.slice(0,a.length-1));break;case"delimiter":return bB(a=a.slice(0,a.length-1))}return a},bC=a=>JSON.parse((a=>{let b="";return a.map(a=>{"string"===a.type?b+='"'+a.value+'"':b+=a.value}),b})((a=>{let b=[];return a.map(a=>{"brace"===a.type&&("{"===a.value?b.push("}"):b.splice(b.lastIndexOf("}"),1)),"paren"===a.type&&("["===a.value?b.push("]"):b.splice(b.lastIndexOf("]"),1))}),b.length>0&&b.reverse().map(b=>{"}"===b?a.push({type:"brace",value:"}"}):"]"===b&&a.push({type:"paren",value:"]"})}),a})(bB((a=>{let b=0,c=[];for(;b<a.length;){let d=a[b];if("\\"===d){b++;continue}if("{"===d){c.push({type:"brace",value:"{"}),b++;continue}if("}"===d){c.push({type:"brace",value:"}"}),b++;continue}if("["===d){c.push({type:"paren",value:"["}),b++;continue}if("]"===d){c.push({type:"paren",value:"]"}),b++;continue}if(":"===d){c.push({type:"separator",value:":"}),b++;continue}if(","===d){c.push({type:"delimiter",value:","}),b++;continue}if('"'===d){let e="",f=!1;for(d=a[++b];'"'!==d;){if(b===a.length){f=!0;break}if("\\"===d){if(++b===a.length){f=!0;break}e+=d+a[b],d=a[++b]}else e+=d,d=a[++b]}d=a[++b],f||c.push({type:"string",value:e});continue}let e=/\s/;if(d&&e.test(d)){b++;continue}let f=/[0-9]/;if(d&&f.test(d)||"-"===d||"."===d){let e="";for("-"===d&&(e+=d,d=a[++b]);d&&f.test(d)||"."===d;)e+=d,d=a[++b];c.push({type:"number",value:e});continue}let g=/[a-z]/i;if(d&&g.test(d)){let e="";for(;d&&g.test(d)&&b!==a.length;)e+=d,d=a[++b];"true"==e||"false"==e||"null"===e?c.push({type:"name",value:e}):b++;continue}b++}return c})(a))))),bD="__json_buf";function bE(a){return"tool_use"===a.type||"server_tool_use"===a.type||"mcp_tool_use"===a.type}class bF{constructor(){i.add(this),this.messages=[],this.receivedMessages=[],j.set(this,void 0),this.controller=new AbortController,k.set(this,void 0),l.set(this,()=>{}),m.set(this,()=>{}),n.set(this,void 0),o.set(this,()=>{}),p.set(this,()=>{}),q.set(this,{}),r.set(this,!1),s.set(this,!1),t.set(this,!1),u.set(this,!1),v.set(this,void 0),w.set(this,void 0),z.set(this,a=>{if(ap(this,s,!0,"f"),as(a)&&(a=new aw),a instanceof aw)return ap(this,t,!0,"f"),this._emit("abort",a);if(a instanceof au)return this._emit("error",a);if(a instanceof Error){let b=new au(a.message);return b.cause=a,this._emit("error",b)}return this._emit("error",new au(String(a)))}),ap(this,k,new Promise((a,b)=>{ap(this,l,a,"f"),ap(this,m,b,"f")}),"f"),ap(this,n,new Promise((a,b)=>{ap(this,o,a,"f"),ap(this,p,b,"f")}),"f"),aq(this,k,"f").catch(()=>{}),aq(this,n,"f").catch(()=>{})}get response(){return aq(this,v,"f")}get request_id(){return aq(this,w,"f")}async withResponse(){let a=await aq(this,k,"f");if(!a)throw Error("Could not resolve a `Response` object");return{data:this,response:a,request_id:a.headers.get("request-id")}}static fromReadableStream(a){let b=new bF;return b._run(()=>b._fromReadableStream(a)),b}static createMessage(a,b,c){let d=new bF;for(let a of b.messages)d._addMessageParam(a);return d._run(()=>d._createMessage(a,{...b,stream:!0},{...c,headers:{...c?.headers,"X-Stainless-Helper-Method":"stream"}})),d}_run(a){a().then(()=>{this._emitFinal(),this._emit("end")},aq(this,z,"f"))}_addMessageParam(a){this.messages.push(a)}_addMessage(a,b=!0){this.receivedMessages.push(a),b&&this._emit("message",a)}async _createMessage(a,b,c){let d,e=c?.signal;e&&(e.aborted&&this.controller.abort(),d=this.controller.abort.bind(this.controller),e.addEventListener("abort",d));try{aq(this,i,"m",A).call(this);let{response:d,data:e}=await a.create({...b,stream:!0},{...c,signal:this.controller.signal}).withResponse();for await(let a of(this._connected(d),e))aq(this,i,"m",B).call(this,a);if(e.controller.signal?.aborted)throw new aw;aq(this,i,"m",C).call(this)}finally{e&&d&&e.removeEventListener("abort",d)}}_connected(a){this.ended||(ap(this,v,a,"f"),ap(this,w,a?.headers.get("request-id"),"f"),aq(this,l,"f").call(this,a),this._emit("connect"))}get ended(){return aq(this,r,"f")}get errored(){return aq(this,s,"f")}get aborted(){return aq(this,t,"f")}abort(){this.controller.abort()}on(a,b){return(aq(this,q,"f")[a]||(aq(this,q,"f")[a]=[])).push({listener:b}),this}off(a,b){let c=aq(this,q,"f")[a];if(!c)return this;let d=c.findIndex(a=>a.listener===b);return d>=0&&c.splice(d,1),this}once(a,b){return(aq(this,q,"f")[a]||(aq(this,q,"f")[a]=[])).push({listener:b,once:!0}),this}emitted(a){return new Promise((b,c)=>{ap(this,u,!0,"f"),"error"!==a&&this.once("error",c),this.once(a,b)})}async done(){ap(this,u,!0,"f"),await aq(this,n,"f")}get currentMessage(){return aq(this,j,"f")}async finalMessage(){return await this.done(),aq(this,i,"m",x).call(this)}async finalText(){return await this.done(),aq(this,i,"m",y).call(this)}_emit(a,...b){if(aq(this,r,"f"))return;"end"===a&&(ap(this,r,!0,"f"),aq(this,o,"f").call(this));let c=aq(this,q,"f")[a];if(c&&(aq(this,q,"f")[a]=c.filter(a=>!a.once),c.forEach(({listener:a})=>a(...b))),"abort"===a){let a=b[0];aq(this,u,"f")||c?.length||Promise.reject(a),aq(this,m,"f").call(this,a),aq(this,p,"f").call(this,a),this._emit("end");return}if("error"===a){let a=b[0];aq(this,u,"f")||c?.length||Promise.reject(a),aq(this,m,"f").call(this,a),aq(this,p,"f").call(this,a),this._emit("end")}}_emitFinal(){this.receivedMessages.at(-1)&&this._emit("finalMessage",aq(this,i,"m",x).call(this))}async _fromReadableStream(a,b){let c,d=b?.signal;d&&(d.aborted&&this.controller.abort(),c=this.controller.abort.bind(this.controller),d.addEventListener("abort",c));try{aq(this,i,"m",A).call(this),this._connected(null);let b=a3.fromReadableStream(a,this.controller);for await(let a of b)aq(this,i,"m",B).call(this,a);if(b.controller.signal?.aborted)throw new aw;aq(this,i,"m",C).call(this)}finally{d&&c&&d.removeEventListener("abort",c)}}[(j=new WeakMap,k=new WeakMap,l=new WeakMap,m=new WeakMap,n=new WeakMap,o=new WeakMap,p=new WeakMap,q=new WeakMap,r=new WeakMap,s=new WeakMap,t=new WeakMap,u=new WeakMap,v=new WeakMap,w=new WeakMap,z=new WeakMap,i=new WeakSet,x=function(){if(0===this.receivedMessages.length)throw new au("stream ended without producing a Message with role=assistant");return this.receivedMessages.at(-1)},y=function(){if(0===this.receivedMessages.length)throw new au("stream ended without producing a Message with role=assistant");let a=this.receivedMessages.at(-1).content.filter(a=>"text"===a.type).map(a=>a.text);if(0===a.length)throw new au("stream ended without producing a content block with type=text");return a.join(" ")},A=function(){this.ended||ap(this,j,void 0,"f")},B=function(a){if(this.ended)return;let b=aq(this,i,"m",D).call(this,a);switch(this._emit("streamEvent",a,b),a.type){case"content_block_delta":{let c=b.content.at(-1);switch(a.delta.type){case"text_delta":"text"===c.type&&this._emit("text",a.delta.text,c.text||"");break;case"citations_delta":"text"===c.type&&this._emit("citation",a.delta.citation,c.citations??[]);break;case"input_json_delta":bE(c)&&c.input&&this._emit("inputJson",a.delta.partial_json,c.input);break;case"thinking_delta":"thinking"===c.type&&this._emit("thinking",a.delta.thinking,c.thinking);break;case"signature_delta":"thinking"===c.type&&this._emit("signature",c.signature);break;default:a.delta}break}case"message_stop":this._addMessageParam(b),this._addMessage(b,!0);break;case"content_block_stop":this._emit("contentBlock",b.content.at(-1));break;case"message_start":ap(this,j,b,"f")}},C=function(){if(this.ended)throw new au("stream has ended, this shouldn't happen");let a=aq(this,j,"f");if(!a)throw new au("request ended without sending any chunks");return ap(this,j,void 0,"f"),a},D=function(a){let b=aq(this,j,"f");if("message_start"===a.type){if(b)throw new au(`Unexpected event order, got ${a.type} before receiving "message_stop"`);return a.message}if(!b)throw new au(`Unexpected event order, got ${a.type} before "message_start"`);switch(a.type){case"message_stop":case"content_block_stop":return b;case"message_delta":return b.container=a.delta.container,b.stop_reason=a.delta.stop_reason,b.stop_sequence=a.delta.stop_sequence,b.usage.output_tokens=a.usage.output_tokens,b.context_management=a.context_management,null!=a.usage.input_tokens&&(b.usage.input_tokens=a.usage.input_tokens),null!=a.usage.cache_creation_input_tokens&&(b.usage.cache_creation_input_tokens=a.usage.cache_creation_input_tokens),null!=a.usage.cache_read_input_tokens&&(b.usage.cache_read_input_tokens=a.usage.cache_read_input_tokens),null!=a.usage.server_tool_use&&(b.usage.server_tool_use=a.usage.server_tool_use),b;case"content_block_start":return b.content.push(a.content_block),b;case"content_block_delta":{let c=b.content.at(a.index);switch(a.delta.type){case"text_delta":c?.type==="text"&&(b.content[a.index]={...c,text:(c.text||"")+a.delta.text});break;case"citations_delta":c?.type==="text"&&(b.content[a.index]={...c,citations:[...c.citations??[],a.delta.citation]});break;case"input_json_delta":if(c&&bE(c)){let d=c[bD]||"";d+=a.delta.partial_json;let e={...c};if(Object.defineProperty(e,bD,{value:d,enumerable:!1,writable:!0}),d)try{e.input=bC(d)}catch(b){let a=new au(`Unable to parse tool parameter JSON from model. Please retry your request or adjust your prompt. Error: ${b}. JSON: ${d}`);aq(this,z,"f").call(this,a)}b.content[a.index]=e}break;case"thinking_delta":c?.type==="thinking"&&(b.content[a.index]={...c,thinking:c.thinking+a.delta.thinking});break;case"signature_delta":c?.type==="thinking"&&(b.content[a.index]={...c,signature:a.delta.signature});break;default:a.delta}return b}}},Symbol.asyncIterator)](){let a=[],b=[],c=!1;return this.on("streamEvent",c=>{let d=b.shift();d?d.resolve(c):a.push(c)}),this.on("end",()=>{for(let a of(c=!0,b))a.resolve(void 0);b.length=0}),this.on("abort",a=>{for(let d of(c=!0,b))d.reject(a);b.length=0}),this.on("error",a=>{for(let d of(c=!0,b))d.reject(a);b.length=0}),{next:async()=>a.length?{value:a.shift(),done:!1}:c?{value:void 0,done:!0}:new Promise((a,c)=>b.push({resolve:a,reject:c})).then(a=>a?{value:a,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new a3(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}let bG={"claude-opus-4-20250514":8192,"claude-opus-4-0":8192,"claude-4-opus-20250514":8192,"anthropic.claude-opus-4-20250514-v1:0":8192,"claude-opus-4@20250514":8192,"claude-opus-4-1-20250805":8192,"anthropic.claude-opus-4-1-20250805-v1:0":8192,"claude-opus-4-1@20250805":8192};function bH(){let a,b;return{promise:new Promise((c,d)=>{a=c,b=d}),resolve:a,reject:b}}class bI{constructor(a,b,c){E.add(this),this.client=a,F.set(this,!1),G.set(this,!1),H.set(this,void 0),I.set(this,void 0),J.set(this,void 0),K.set(this,void 0),L.set(this,void 0),M.set(this,0),ap(this,H,{params:{...b,messages:structuredClone(b.messages)}},"f"),ap(this,I,{...c,headers:bt([{"x-stainless-helper":"BetaToolRunner"},c?.headers])},"f"),ap(this,L,bH(),"f")}async *[(F=new WeakMap,G=new WeakMap,H=new WeakMap,I=new WeakMap,J=new WeakMap,K=new WeakMap,L=new WeakMap,M=new WeakMap,E=new WeakSet,Symbol.asyncIterator)](){var a;if(aq(this,F,"f"))throw new au("Cannot iterate over a consumed stream");ap(this,F,!0,"f"),ap(this,G,!0,"f"),ap(this,K,void 0,"f");try{for(;;){let b;try{if(aq(this,H,"f").params.max_iterations&&aq(this,M,"f")>=aq(this,H,"f").params.max_iterations)break;ap(this,G,!1,"f"),ap(this,J,void 0,"f"),ap(this,K,void 0,"f"),ap(this,M,(a=aq(this,M,"f"),++a),"f");let{max_iterations:c,...d}=aq(this,H,"f").params;if(d.stream?(b=this.client.beta.messages.stream({...d},aq(this,I,"f")),ap(this,J,b.finalMessage(),"f"),aq(this,J,"f").catch(()=>{}),yield b):(ap(this,J,this.client.beta.messages.create({...d,stream:!1},aq(this,I,"f")),"f"),yield aq(this,J,"f")),!aq(this,G,"f")){let{role:a,content:b}=await aq(this,J,"f");aq(this,H,"f").params.messages.push({role:a,content:b})}let e=await aq(this,E,"m",N).call(this,aq(this,H,"f").params.messages.at(-1));if(e&&aq(this,H,"f").params.messages.push(e),!e&&!aq(this,G,"f"))break}finally{b&&b.abort()}}if(!aq(this,J,"f"))throw new au("ToolRunner concluded without a message from the server");aq(this,L,"f").resolve(await aq(this,J,"f"))}catch(a){throw ap(this,F,!1,"f"),aq(this,L,"f").promise.catch(()=>{}),aq(this,L,"f").reject(a),ap(this,L,bH(),"f"),a}}setMessagesParams(a){"function"==typeof a?aq(this,H,"f").params=a(aq(this,H,"f").params):aq(this,H,"f").params=a,ap(this,G,!0,"f"),ap(this,K,void 0,"f")}async generateToolResponse(){let a=await aq(this,J,"f")??this.params.messages.at(-1);return a?aq(this,E,"m",N).call(this,a):null}done(){return aq(this,L,"f").promise}async runUntilDone(){if(!aq(this,F,"f"))for await(let a of this);return this.done()}get params(){return aq(this,H,"f").params}pushMessages(...a){this.setMessagesParams(b=>({...b,messages:[...b.messages,...a]}))}then(a,b){return this.runUntilDone().then(a,b)}}async function bJ(a,b=a.messages.at(-1)){if(!b||"assistant"!==b.role||!b.content||"string"==typeof b.content)return null;let c=b.content.filter(a=>"tool_use"===a.type);return 0===c.length?null:{role:"user",content:await Promise.all(c.map(async b=>{let c=a.tools.find(a=>a.name===b.name);if(!c||!("run"in c))return{type:"tool_result",tool_use_id:b.id,content:`Error: Tool '${b.name}' not found`,is_error:!0};try{let a=b.input;"parse"in c&&c.parse&&(a=c.parse(a));let d=await c.run(a);return{type:"tool_result",tool_use_id:b.id,content:d}}catch(a){return{type:"tool_result",tool_use_id:b.id,content:`Error: ${a instanceof Error?a.message:String(a)}`,is_error:!0}}}))}}N=async function(a){return void 0!==aq(this,K,"f")||ap(this,K,bJ(aq(this,H,"f").params,a),"f"),aq(this,K,"f")};let bK={"claude-1.3":"November 6th, 2024","claude-1.3-100k":"November 6th, 2024","claude-instant-1.1":"November 6th, 2024","claude-instant-1.1-100k":"November 6th, 2024","claude-instant-1.2":"November 6th, 2024","claude-3-sonnet-20240229":"July 21st, 2025","claude-3-opus-20240229":"January 5th, 2026","claude-2.1":"July 21st, 2025","claude-2.0":"July 21st, 2025","claude-3-7-sonnet-latest":"February 19th, 2026","claude-3-7-sonnet-20250219":"February 19th, 2026"};class bL extends br{constructor(){super(...arguments),this.batches=new bA(this._client)}create(a,b){let{betas:c,...d}=a;d.model in bK&&console.warn(`The model '${d.model}' is deprecated and will reach end-of-life on ${bK[d.model]}
Please migrate to a newer model. Visit https://docs.anthropic.com/en/docs/resources/model-deprecations for more information.`);let e=this._client._options.timeout;if(!d.stream&&null==e){let a=bG[d.model]??void 0;e=this._client.calculateNonstreamingTimeout(d.max_tokens,a)}return this._client.post("/v1/messages?beta=true",{body:d,timeout:e??6e5,...b,headers:bt([{...c?.toString()!=null?{"anthropic-beta":c?.toString()}:void 0},b?.headers]),stream:a.stream??!1})}stream(a,b){return bF.createMessage(this,a,b)}countTokens(a,b){let{betas:c,...d}=a;return this._client.post("/v1/messages/count_tokens?beta=true",{body:d,...b,headers:bt([{"anthropic-beta":[...c??[],"token-counting-2024-11-01"].toString()},b?.headers])})}toolRunner(a,b){return new bI(this._client,a,b)}}bL.Batches=bA,bL.BetaToolRunner=bI;class bM extends br{create(a,b={},c){let{betas:d,...e}=b??{};return this._client.post(bw`/v1/skills/${a}/versions?beta=true`,bi({body:e,...c,headers:bt([{"anthropic-beta":[...d??[],"skills-2025-10-02"].toString()},c?.headers])},this._client))}retrieve(a,b,c){let{skill_id:d,betas:e}=b;return this._client.get(bw`/v1/skills/${d}/versions/${a}?beta=true`,{...c,headers:bt([{"anthropic-beta":[...e??[],"skills-2025-10-02"].toString()},c?.headers])})}list(a,b={},c){let{betas:d,...e}=b??{};return this._client.getAPIList(bw`/v1/skills/${a}/versions?beta=true`,bd,{query:e,...c,headers:bt([{"anthropic-beta":[...d??[],"skills-2025-10-02"].toString()},c?.headers])})}delete(a,b,c){let{skill_id:d,betas:e}=b;return this._client.delete(bw`/v1/skills/${d}/versions/${a}?beta=true`,{...c,headers:bt([{"anthropic-beta":[...e??[],"skills-2025-10-02"].toString()},c?.headers])})}}class bN extends br{constructor(){super(...arguments),this.versions=new bM(this._client)}create(a={},b){let{betas:c,...d}=a??{};return this._client.post("/v1/skills?beta=true",bi({body:d,...b,headers:bt([{"anthropic-beta":[...c??[],"skills-2025-10-02"].toString()},b?.headers])},this._client))}retrieve(a,b={},c){let{betas:d}=b??{};return this._client.get(bw`/v1/skills/${a}?beta=true`,{...c,headers:bt([{"anthropic-beta":[...d??[],"skills-2025-10-02"].toString()},c?.headers])})}list(a={},b){let{betas:c,...d}=a??{};return this._client.getAPIList("/v1/skills?beta=true",bd,{query:d,...b,headers:bt([{"anthropic-beta":[...c??[],"skills-2025-10-02"].toString()},b?.headers])})}delete(a,b={},c){let{betas:d}=b??{};return this._client.delete(bw`/v1/skills/${a}?beta=true`,{...c,headers:bt([{"anthropic-beta":[...d??[],"skills-2025-10-02"].toString()},c?.headers])})}}bN.Versions=bM;class bO extends br{constructor(){super(...arguments),this.models=new by(this._client),this.messages=new bL(this._client),this.files=new bx(this._client),this.skills=new bN(this._client)}}bO.Models=by,bO.Messages=bL,bO.Files=bx,bO.Skills=bN;class bP extends br{create(a,b){let{betas:c,...d}=a;return this._client.post("/v1/complete",{body:d,timeout:this._client._options.timeout??6e5,...b,headers:bt([{...c?.toString()!=null?{"anthropic-beta":c?.toString()}:void 0},b?.headers]),stream:a.stream??!1})}}let bQ="__json_buf";function bR(a){return"tool_use"===a.type||"server_tool_use"===a.type}class bS{constructor(){O.add(this),this.messages=[],this.receivedMessages=[],P.set(this,void 0),this.controller=new AbortController,Q.set(this,void 0),R.set(this,()=>{}),S.set(this,()=>{}),T.set(this,void 0),U.set(this,()=>{}),V.set(this,()=>{}),W.set(this,{}),X.set(this,!1),Y.set(this,!1),Z.set(this,!1),$.set(this,!1),_.set(this,void 0),aa.set(this,void 0),ad.set(this,a=>{if(ap(this,Y,!0,"f"),as(a)&&(a=new aw),a instanceof aw)return ap(this,Z,!0,"f"),this._emit("abort",a);if(a instanceof au)return this._emit("error",a);if(a instanceof Error){let b=new au(a.message);return b.cause=a,this._emit("error",b)}return this._emit("error",new au(String(a)))}),ap(this,Q,new Promise((a,b)=>{ap(this,R,a,"f"),ap(this,S,b,"f")}),"f"),ap(this,T,new Promise((a,b)=>{ap(this,U,a,"f"),ap(this,V,b,"f")}),"f"),aq(this,Q,"f").catch(()=>{}),aq(this,T,"f").catch(()=>{})}get response(){return aq(this,_,"f")}get request_id(){return aq(this,aa,"f")}async withResponse(){let a=await aq(this,Q,"f");if(!a)throw Error("Could not resolve a `Response` object");return{data:this,response:a,request_id:a.headers.get("request-id")}}static fromReadableStream(a){let b=new bS;return b._run(()=>b._fromReadableStream(a)),b}static createMessage(a,b,c){let d=new bS;for(let a of b.messages)d._addMessageParam(a);return d._run(()=>d._createMessage(a,{...b,stream:!0},{...c,headers:{...c?.headers,"X-Stainless-Helper-Method":"stream"}})),d}_run(a){a().then(()=>{this._emitFinal(),this._emit("end")},aq(this,ad,"f"))}_addMessageParam(a){this.messages.push(a)}_addMessage(a,b=!0){this.receivedMessages.push(a),b&&this._emit("message",a)}async _createMessage(a,b,c){let d,e=c?.signal;e&&(e.aborted&&this.controller.abort(),d=this.controller.abort.bind(this.controller),e.addEventListener("abort",d));try{aq(this,O,"m",ae).call(this);let{response:d,data:e}=await a.create({...b,stream:!0},{...c,signal:this.controller.signal}).withResponse();for await(let a of(this._connected(d),e))aq(this,O,"m",af).call(this,a);if(e.controller.signal?.aborted)throw new aw;aq(this,O,"m",ag).call(this)}finally{e&&d&&e.removeEventListener("abort",d)}}_connected(a){this.ended||(ap(this,_,a,"f"),ap(this,aa,a?.headers.get("request-id"),"f"),aq(this,R,"f").call(this,a),this._emit("connect"))}get ended(){return aq(this,X,"f")}get errored(){return aq(this,Y,"f")}get aborted(){return aq(this,Z,"f")}abort(){this.controller.abort()}on(a,b){return(aq(this,W,"f")[a]||(aq(this,W,"f")[a]=[])).push({listener:b}),this}off(a,b){let c=aq(this,W,"f")[a];if(!c)return this;let d=c.findIndex(a=>a.listener===b);return d>=0&&c.splice(d,1),this}once(a,b){return(aq(this,W,"f")[a]||(aq(this,W,"f")[a]=[])).push({listener:b,once:!0}),this}emitted(a){return new Promise((b,c)=>{ap(this,$,!0,"f"),"error"!==a&&this.once("error",c),this.once(a,b)})}async done(){ap(this,$,!0,"f"),await aq(this,T,"f")}get currentMessage(){return aq(this,P,"f")}async finalMessage(){return await this.done(),aq(this,O,"m",ab).call(this)}async finalText(){return await this.done(),aq(this,O,"m",ac).call(this)}_emit(a,...b){if(aq(this,X,"f"))return;"end"===a&&(ap(this,X,!0,"f"),aq(this,U,"f").call(this));let c=aq(this,W,"f")[a];if(c&&(aq(this,W,"f")[a]=c.filter(a=>!a.once),c.forEach(({listener:a})=>a(...b))),"abort"===a){let a=b[0];aq(this,$,"f")||c?.length||Promise.reject(a),aq(this,S,"f").call(this,a),aq(this,V,"f").call(this,a),this._emit("end");return}if("error"===a){let a=b[0];aq(this,$,"f")||c?.length||Promise.reject(a),aq(this,S,"f").call(this,a),aq(this,V,"f").call(this,a),this._emit("end")}}_emitFinal(){this.receivedMessages.at(-1)&&this._emit("finalMessage",aq(this,O,"m",ab).call(this))}async _fromReadableStream(a,b){let c,d=b?.signal;d&&(d.aborted&&this.controller.abort(),c=this.controller.abort.bind(this.controller),d.addEventListener("abort",c));try{aq(this,O,"m",ae).call(this),this._connected(null);let b=a3.fromReadableStream(a,this.controller);for await(let a of b)aq(this,O,"m",af).call(this,a);if(b.controller.signal?.aborted)throw new aw;aq(this,O,"m",ag).call(this)}finally{d&&c&&d.removeEventListener("abort",c)}}[(P=new WeakMap,Q=new WeakMap,R=new WeakMap,S=new WeakMap,T=new WeakMap,U=new WeakMap,V=new WeakMap,W=new WeakMap,X=new WeakMap,Y=new WeakMap,Z=new WeakMap,$=new WeakMap,_=new WeakMap,aa=new WeakMap,ad=new WeakMap,O=new WeakSet,ab=function(){if(0===this.receivedMessages.length)throw new au("stream ended without producing a Message with role=assistant");return this.receivedMessages.at(-1)},ac=function(){if(0===this.receivedMessages.length)throw new au("stream ended without producing a Message with role=assistant");let a=this.receivedMessages.at(-1).content.filter(a=>"text"===a.type).map(a=>a.text);if(0===a.length)throw new au("stream ended without producing a content block with type=text");return a.join(" ")},ae=function(){this.ended||ap(this,P,void 0,"f")},af=function(a){if(this.ended)return;let b=aq(this,O,"m",ah).call(this,a);switch(this._emit("streamEvent",a,b),a.type){case"content_block_delta":{let c=b.content.at(-1);switch(a.delta.type){case"text_delta":"text"===c.type&&this._emit("text",a.delta.text,c.text||"");break;case"citations_delta":"text"===c.type&&this._emit("citation",a.delta.citation,c.citations??[]);break;case"input_json_delta":bR(c)&&c.input&&this._emit("inputJson",a.delta.partial_json,c.input);break;case"thinking_delta":"thinking"===c.type&&this._emit("thinking",a.delta.thinking,c.thinking);break;case"signature_delta":"thinking"===c.type&&this._emit("signature",c.signature);break;default:a.delta}break}case"message_stop":this._addMessageParam(b),this._addMessage(b,!0);break;case"content_block_stop":this._emit("contentBlock",b.content.at(-1));break;case"message_start":ap(this,P,b,"f")}},ag=function(){if(this.ended)throw new au("stream has ended, this shouldn't happen");let a=aq(this,P,"f");if(!a)throw new au("request ended without sending any chunks");return ap(this,P,void 0,"f"),a},ah=function(a){let b=aq(this,P,"f");if("message_start"===a.type){if(b)throw new au(`Unexpected event order, got ${a.type} before receiving "message_stop"`);return a.message}if(!b)throw new au(`Unexpected event order, got ${a.type} before "message_start"`);switch(a.type){case"message_stop":case"content_block_stop":return b;case"message_delta":return b.stop_reason=a.delta.stop_reason,b.stop_sequence=a.delta.stop_sequence,b.usage.output_tokens=a.usage.output_tokens,null!=a.usage.input_tokens&&(b.usage.input_tokens=a.usage.input_tokens),null!=a.usage.cache_creation_input_tokens&&(b.usage.cache_creation_input_tokens=a.usage.cache_creation_input_tokens),null!=a.usage.cache_read_input_tokens&&(b.usage.cache_read_input_tokens=a.usage.cache_read_input_tokens),null!=a.usage.server_tool_use&&(b.usage.server_tool_use=a.usage.server_tool_use),b;case"content_block_start":return b.content.push({...a.content_block}),b;case"content_block_delta":{let c=b.content.at(a.index);switch(a.delta.type){case"text_delta":c?.type==="text"&&(b.content[a.index]={...c,text:(c.text||"")+a.delta.text});break;case"citations_delta":c?.type==="text"&&(b.content[a.index]={...c,citations:[...c.citations??[],a.delta.citation]});break;case"input_json_delta":if(c&&bR(c)){let d=c[bQ]||"";d+=a.delta.partial_json;let e={...c};Object.defineProperty(e,bQ,{value:d,enumerable:!1,writable:!0}),d&&(e.input=bC(d)),b.content[a.index]=e}break;case"thinking_delta":c?.type==="thinking"&&(b.content[a.index]={...c,thinking:c.thinking+a.delta.thinking});break;case"signature_delta":c?.type==="thinking"&&(b.content[a.index]={...c,signature:a.delta.signature});break;default:a.delta}return b}}},Symbol.asyncIterator)](){let a=[],b=[],c=!1;return this.on("streamEvent",c=>{let d=b.shift();d?d.resolve(c):a.push(c)}),this.on("end",()=>{for(let a of(c=!0,b))a.resolve(void 0);b.length=0}),this.on("abort",a=>{for(let d of(c=!0,b))d.reject(a);b.length=0}),this.on("error",a=>{for(let d of(c=!0,b))d.reject(a);b.length=0}),{next:async()=>a.length?{value:a.shift(),done:!1}:c?{value:void 0,done:!0}:new Promise((a,c)=>b.push({resolve:a,reject:c})).then(a=>a?{value:a,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new a3(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}class bT extends br{create(a,b){return this._client.post("/v1/messages/batches",{body:a,...b})}retrieve(a,b){return this._client.get(bw`/v1/messages/batches/${a}`,b)}list(a={},b){return this._client.getAPIList("/v1/messages/batches",bc,{query:a,...b})}delete(a,b){return this._client.delete(bw`/v1/messages/batches/${a}`,b)}cancel(a,b){return this._client.post(bw`/v1/messages/batches/${a}/cancel`,b)}async results(a,b){let c=await this.retrieve(a);if(!c.results_url)throw new au(`No batch \`results_url\`; Has it finished processing? ${c.processing_status} - ${c.id}`);return this._client.get(c.results_url,{...b,headers:bt([{Accept:"application/binary"},b?.headers]),stream:!0,__binaryResponse:!0})._thenUnwrap((a,b)=>bz.fromResponse(b.response,b.controller))}}class bU extends br{constructor(){super(...arguments),this.batches=new bT(this._client)}create(a,b){a.model in bV&&console.warn(`The model '${a.model}' is deprecated and will reach end-of-life on ${bV[a.model]}
Please migrate to a newer model. Visit https://docs.anthropic.com/en/docs/resources/model-deprecations for more information.`);let c=this._client._options.timeout;if(!a.stream&&null==c){let b=bG[a.model]??void 0;c=this._client.calculateNonstreamingTimeout(a.max_tokens,b)}return this._client.post("/v1/messages",{body:a,timeout:c??6e5,...b,stream:a.stream??!1})}stream(a,b){return bS.createMessage(this,a,b)}countTokens(a,b){return this._client.post("/v1/messages/count_tokens",{body:a,...b})}}let bV={"claude-1.3":"November 6th, 2024","claude-1.3-100k":"November 6th, 2024","claude-instant-1.1":"November 6th, 2024","claude-instant-1.1-100k":"November 6th, 2024","claude-instant-1.2":"November 6th, 2024","claude-3-sonnet-20240229":"July 21st, 2025","claude-3-opus-20240229":"January 5th, 2026","claude-2.1":"July 21st, 2025","claude-2.0":"July 21st, 2025","claude-3-7-sonnet-latest":"February 19th, 2026","claude-3-7-sonnet-20250219":"February 19th, 2026"};bU.Batches=bT;class bW extends br{retrieve(a,b={},c){let{betas:d}=b??{};return this._client.get(bw`/v1/models/${a}`,{...c,headers:bt([{...d?.toString()!=null?{"anthropic-beta":d?.toString()}:void 0},c?.headers])})}list(a={},b){let{betas:c,...d}=a??{};return this._client.getAPIList("/v1/models",bc,{query:d,...b,headers:bt([{...c?.toString()!=null?{"anthropic-beta":c?.toString()}:void 0},b?.headers])})}}let bX=a=>void 0!==globalThis.process?globalThis.process.env?.[a]?.trim()??void 0:void 0!==globalThis.Deno?globalThis.Deno.env?.get?.(a)?.trim():void 0;class bY{constructor({baseURL:a=bX("ANTHROPIC_BASE_URL"),apiKey:b=bX("ANTHROPIC_API_KEY")??null,authToken:c=bX("ANTHROPIC_AUTH_TOKEN")??null,...d}={}){ai.add(this),ak.set(this,void 0);let e={apiKey:b,authToken:c,...d,baseURL:a||"https://api.anthropic.com"};if(!e.dangerouslyAllowBrowser&&"undefined"!=typeof window&&void 0!==window.document&&"undefined"!=typeof navigator)throw new au("It looks like you're running in a browser-like environment.\n\nThis is disabled by default, as it risks exposing your secret API credentials to attackers.\nIf you understand the risks and have appropriate mitigations in place,\nyou can set the `dangerouslyAllowBrowser` option to `true`, e.g.,\n\nnew Anthropic({ apiKey, dangerouslyAllowBrowser: true });\n");this.baseURL=e.baseURL,this.timeout=e.timeout??aj.DEFAULT_TIMEOUT,this.logger=e.logger??console;let f="warn";this.logLevel=f,this.logLevel=aY(e.logLevel,"ClientOptions.logLevel",this)??aY(bX("ANTHROPIC_LOG"),"process.env['ANTHROPIC_LOG']",this)??f,this.fetchOptions=e.fetchOptions,this.maxRetries=e.maxRetries??2,this.fetch=e.fetch??function(){if("undefined"!=typeof fetch)return fetch;throw Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new Anthropic({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}(),ap(this,ak,aT,"f"),this._options=e,this.apiKey=b,this.authToken=c}withOptions(a){return new this.constructor({...this._options,baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,authToken:this.authToken,...a})}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:a,nulls:b}){if(!(this.apiKey&&a.get("x-api-key")||b.has("x-api-key")||this.authToken&&a.get("authorization"))&&!b.has("authorization"))throw Error('Could not resolve authentication method. Expected either apiKey or authToken to be set. Or for one of the "X-Api-Key" or "Authorization" headers to be explicitly omitted')}async authHeaders(a){return bt([await this.apiKeyAuth(a),await this.bearerAuth(a)])}async apiKeyAuth(a){if(null!=this.apiKey)return bt([{"X-Api-Key":this.apiKey}])}async bearerAuth(a){if(null!=this.authToken)return bt([{Authorization:`Bearer ${this.authToken}`}])}stringifyQuery(a){return Object.entries(a).filter(([a,b])=>void 0!==b).map(([a,b])=>{if("string"==typeof b||"number"==typeof b||"boolean"==typeof b)return`${encodeURIComponent(a)}=${encodeURIComponent(b)}`;if(null===b)return`${encodeURIComponent(a)}=`;throw new au(`Cannot stringify type ${typeof b}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}getUserAgent(){return`${this.constructor.name}/JS ${aM}`}defaultIdempotencyKey(){return`stainless-node-retry-${ar()}`}makeStatusError(a,b,c,d){return av.generate(a,b,c,d)}buildURL(a,b,c){let d=!aq(this,ai,"m",al).call(this)&&c||this.baseURL,e=new URL(aH.test(a)?a:d+(d.endsWith("/")&&a.startsWith("/")?a.slice(1):a)),f=this.defaultQuery();return!function(a){if(!a)return!0;for(let b in a)return!1;return!0}(f)&&(b={...f,...b}),"object"==typeof b&&b&&!Array.isArray(b)&&(e.search=this.stringifyQuery(b)),e.toString()}_calculateNonstreamingTimeout(a){if(3600*a/128e3>600)throw new au("Streaming is required for operations that may take longer than 10 minutes. See https://github.com/anthropics/anthropic-sdk-typescript#streaming-responses for more details");return 6e5}async prepareOptions(a){}async prepareRequest(a,{url:b,options:c}){}get(a,b){return this.methodRequest("get",a,b)}post(a,b){return this.methodRequest("post",a,b)}patch(a,b){return this.methodRequest("patch",a,b)}put(a,b){return this.methodRequest("put",a,b)}delete(a,b){return this.methodRequest("delete",a,b)}methodRequest(a,b,c){return this.request(Promise.resolve(c).then(c=>({method:a,path:b,...c})))}request(a,b=null){return new a9(this,this.makeRequest(a,b,void 0))}async makeRequest(a,b,c){let d=await a,e=d.maxRetries??this.maxRetries;null==b&&(b=e),await this.prepareOptions(d);let{req:f,url:g,timeout:h}=await this.buildRequest(d,{retryCount:e-b});await this.prepareRequest(f,{url:g,options:d});let i="log_"+(0x1000000*Math.random()|0).toString(16).padStart(6,"0"),j=void 0===c?"":`, retryOf: ${c}`,k=Date.now();if(a1(this).debug(`[${i}] sending request`,a2({retryOfRequestLogID:c,method:d.method,url:g,options:d,headers:f.headers})),d.signal?.aborted)throw new aw;let l=new AbortController,m=await this.fetchWithTimeout(g,f,h,l).catch(at),n=Date.now();if(m instanceof globalThis.Error){let a=`retrying, ${b} attempts remaining`;if(d.signal?.aborted)throw new aw;let e=as(m)||/timed? ?out/i.test(String(m)+("cause"in m?String(m.cause):""));if(b)return a1(this).info(`[${i}] connection ${e?"timed out":"failed"} - ${a}`),a1(this).debug(`[${i}] connection ${e?"timed out":"failed"} (${a})`,a2({retryOfRequestLogID:c,url:g,durationMs:n-k,message:m.message})),this.retryRequest(d,b,c??i);if(a1(this).info(`[${i}] connection ${e?"timed out":"failed"} - error; no more retries left`),a1(this).debug(`[${i}] connection ${e?"timed out":"failed"} (error; no more retries left)`,a2({retryOfRequestLogID:c,url:g,durationMs:n-k,message:m.message})),e)throw new ay;throw new ax({cause:m})}let o=[...m.headers.entries()].filter(([a])=>"request-id"===a).map(([a,b])=>", "+a+": "+JSON.stringify(b)).join(""),p=`[${i}${j}${o}] ${f.method} ${g} ${m.ok?"succeeded":"failed"} with status ${m.status} in ${n-k}ms`;if(!m.ok){let a=await this.shouldRetry(m);if(b&&a){let a=`retrying, ${b} attempts remaining`;return await aS(m.body),a1(this).info(`${p} - ${a}`),a1(this).debug(`[${i}] response error (${a})`,a2({retryOfRequestLogID:c,url:m.url,status:m.status,headers:m.headers,durationMs:n-k})),this.retryRequest(d,b,c??i,m.headers)}let e=a?"error; no more retries left":"error; not retryable";a1(this).info(`${p} - ${e}`);let f=await m.text().catch(a=>at(a).message),g=aL(f),h=g?void 0:f;throw a1(this).debug(`[${i}] response error (${e})`,a2({retryOfRequestLogID:c,url:m.url,status:m.status,headers:m.headers,message:h,durationMs:Date.now()-k})),this.makeStatusError(m.status,g,h,m.headers)}return a1(this).info(p),a1(this).debug(`[${i}] response start`,a2({retryOfRequestLogID:c,url:m.url,status:m.status,headers:m.headers,durationMs:n-k})),{response:m,options:d,controller:l,requestLogID:i,retryOfRequestLogID:c,startTime:k}}getAPIList(a,b,c){return this.requestAPIList(b,{method:"get",path:a,...c})}requestAPIList(a,b){return new bb(this,this.makeRequest(b,null,void 0),a)}async fetchWithTimeout(a,b,c,d){let{signal:e,method:f,...g}=b||{};e&&e.addEventListener("abort",()=>d.abort());let h=setTimeout(()=>d.abort(),c),i=globalThis.ReadableStream&&g.body instanceof globalThis.ReadableStream||"object"==typeof g.body&&null!==g.body&&Symbol.asyncIterator in g.body,j={signal:d.signal,...i?{duplex:"half"}:{},method:"GET",...g};f&&(j.method=f.toUpperCase());try{return await this.fetch.call(void 0,a,j)}finally{clearTimeout(h)}}async shouldRetry(a){let b=a.headers.get("x-should-retry");return"true"===b||"false"!==b&&(408===a.status||409===a.status||429===a.status||!!(a.status>=500))}async retryRequest(a,b,c,d){let e,f,g=d?.get("retry-after-ms");if(g){let a=parseFloat(g);Number.isNaN(a)||(e=a)}let h=d?.get("retry-after");if(h&&!e){let a=parseFloat(h);e=Number.isNaN(a)?Date.parse(h)-Date.now():1e3*a}if(!(e&&0<=e&&e<6e4)){let c=a.maxRetries??this.maxRetries;e=this.calculateDefaultRetryTimeoutMillis(b,c)}return await (f=e,new Promise(a=>setTimeout(a,f))),this.makeRequest(a,b-1,c)}calculateDefaultRetryTimeoutMillis(a,b){return Math.min(.5*Math.pow(2,b-a),8)*(1-.25*Math.random())*1e3}calculateNonstreamingTimeout(a,b){if(36e5*a/128e3>6e5||null!=b&&a>b)throw new au("Streaming is required for operations that may take longer than 10 minutes. See https://github.com/anthropics/anthropic-sdk-typescript#long-requests for more details");return 6e5}async buildRequest(a,{retryCount:b=0}={}){let c={...a},{method:d,path:e,query:f,defaultBaseURL:g}=c,h=this.buildURL(e,f,g);"timeout"in c&&((a,b)=>{if("number"!=typeof b||!Number.isInteger(b))throw new au(`${a} must be an integer`);if(b<0)throw new au(`${a} must be a positive integer`)})("timeout",c.timeout),c.timeout=c.timeout??this.timeout;let{bodyHeaders:i,body:j}=this.buildBody({options:c}),k=await this.buildHeaders({options:a,method:d,bodyHeaders:i,retryCount:b});return{req:{method:d,headers:k,...c.signal&&{signal:c.signal},...globalThis.ReadableStream&&j instanceof globalThis.ReadableStream&&{duplex:"half"},...j&&{body:j},...this.fetchOptions??{},...c.fetchOptions??{}},url:h,timeout:c.timeout}}async buildHeaders({options:a,method:b,bodyHeaders:c,retryCount:d}){let e={};this.idempotencyHeader&&"get"!==b&&(a.idempotencyKey||(a.idempotencyKey=this.defaultIdempotencyKey()),e[this.idempotencyHeader]=a.idempotencyKey);let f=bt([e,{Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(d),...a.timeout?{"X-Stainless-Timeout":String(Math.trunc(a.timeout/1e3))}:{},...am??(am=(()=>{let a="undefined"!=typeof Deno&&null!=Deno.build?"deno":"undefined"!=typeof EdgeRuntime?"edge":"[object process]"===Object.prototype.toString.call(void 0!==globalThis.process?globalThis.process:0)?"node":"unknown";if("deno"===a)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":aM,"X-Stainless-OS":aO(Deno.build.os),"X-Stainless-Arch":aN(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":"string"==typeof Deno.version?Deno.version:Deno.version?.deno??"unknown"};if("undefined"!=typeof EdgeRuntime)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":aM,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if("node"===a)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":aM,"X-Stainless-OS":aO(globalThis.process.platform??"unknown"),"X-Stainless-Arch":aN(globalThis.process.arch??"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":globalThis.process.version??"unknown"};let b=function(){if("undefined"==typeof navigator||!navigator)return null;for(let{key:a,pattern:b}of[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}]){let c=b.exec(navigator.userAgent);if(c){let b=c[1]||0,d=c[2]||0,e=c[3]||0;return{browser:a,version:`${b}.${d}.${e}`}}}return null}();return b?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":aM,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${b.browser}`,"X-Stainless-Runtime-Version":b.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":aM,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}})()),...this._options.dangerouslyAllowBrowser?{"anthropic-dangerous-direct-browser-access":"true"}:void 0,"anthropic-version":"2023-06-01"},await this.authHeaders(a),this._options.defaultHeaders,c,a.headers]);return this.validateHeaders(f),f.values}buildBody({options:{body:a,headers:b}}){if(!a)return{bodyHeaders:void 0,body:void 0};let c=bt([b]);return ArrayBuffer.isView(a)||a instanceof ArrayBuffer||a instanceof DataView||"string"==typeof a&&c.values.has("content-type")||globalThis.Blob&&a instanceof globalThis.Blob||a instanceof FormData||a instanceof URLSearchParams||globalThis.ReadableStream&&a instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:a}:"object"==typeof a&&(Symbol.asyncIterator in a||Symbol.iterator in a&&"next"in a&&"function"==typeof a.next)?{bodyHeaders:void 0,body:aQ(a)}:aq(this,ak,"f").call(this,{body:a,headers:c})}}aj=bY,ak=new WeakMap,ai=new WeakSet,al=function(){return"https://api.anthropic.com"!==this.baseURL},bY.Anthropic=aj,bY.HUMAN_PROMPT="\\n\\nHuman:",bY.AI_PROMPT="\\n\\nAssistant:",bY.DEFAULT_TIMEOUT=6e5,bY.AnthropicError=au,bY.APIError=av,bY.APIConnectionError=ax,bY.APIConnectionTimeoutError=ay,bY.APIUserAbortError=aw,bY.NotFoundError=aC,bY.ConflictError=aD,bY.RateLimitError=aF,bY.BadRequestError=az,bY.AuthenticationError=aA,bY.InternalServerError=aG,bY.PermissionDeniedError=aB,bY.UnprocessableEntityError=aE,bY.toFile=bp;class bZ extends bY{constructor(){super(...arguments),this.completions=new bP(this),this.messages=new bU(this),this.models=new bW(this),this.beta=new bO(this)}}bZ.Completions=bP,bZ.Messages=bU,bZ.Models=bW,bZ.Beta=bO}};